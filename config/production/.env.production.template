# ===============================================================================
# Corporate Intelligence Platform - Production Environment Configuration
# ===============================================================================
# CRITICAL SECURITY NOTICE:
#   - This is a TEMPLATE file - ALL placeholder values MUST be replaced
#   - NEVER commit actual secrets to version control
#   - Use AWS Secrets Manager, HashiCorp Vault, or similar for production secrets
#   - Rotate all credentials every 90 days minimum
#   - Document all external API keys and their rate limits
# ===============================================================================

# ===============================================================================
# ENVIRONMENT IDENTIFICATION
# ===============================================================================
ENVIRONMENT=production
DEPLOYMENT_STAGE=prod
DEPLOYMENT_VERSION=REPLACE_WITH_VERSION_TAG
DEPLOYMENT_DATE=REPLACE_WITH_DEPLOYMENT_DATE
DEPLOYMENT_REGION=us-east-1

# ===============================================================================
# APPLICATION SECURITY
# ===============================================================================
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(64))"
SECRET_KEY=REPLACE_WITH_SECURE_RANDOM_KEY_MINIMUM_64_CHARS
SESSION_SECRET_KEY=REPLACE_WITH_UNIQUE_SESSION_KEY_64_CHARS

# Debug & Logging
DEBUG=false
LOG_LEVEL=WARNING
LOG_FORMAT=json
LOG_FILE=/app/logs/corporate-intel-production.log
LOG_MAX_BYTES=52428800
LOG_BACKUP_COUNT=10

# Session Security
SECURE_COOKIES=true
SESSION_TIMEOUT_MINUTES=30
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_SAMESITE=strict

# Security Headers
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
CONTENT_SECURITY_POLICY_ENABLED=true

# ===============================================================================
# DATABASE CONFIGURATION - PostgreSQL with TimescaleDB
# ===============================================================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=intel_prod_user
POSTGRES_PASSWORD=REPLACE_WITH_AWS_SECRETS_MANAGER_REFERENCE
POSTGRES_DB=corporate_intel_prod

# Connection String (auto-constructed)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# Connection Pool Configuration (Production-Optimized)
DB_POOL_SIZE=30
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=1800
DB_POOL_PRE_PING=true
DB_ECHO=false

# SSL Configuration
DB_SSL_MODE=require
DB_SSL_CERT=/etc/ssl/certs/postgresql.crt
DB_SSL_KEY=/etc/ssl/private/postgresql.key
DB_SSL_ROOT_CERT=/etc/ssl/certs/ca-bundle.crt

# TimescaleDB Configuration
TIMESCALE_COMPRESSION_ENABLED=true
TIMESCALE_COMPRESSION_AFTER_DAYS=7
TIMESCALE_RETENTION_YEARS=5
TIMESCALE_CHUNK_TIME_INTERVAL=1 day
TIMESCALE_BACKGROUND_WORKERS=8

# Backup Configuration
DB_BACKUP_ENABLED=true
DB_BACKUP_SCHEDULE=0 2 * * *
DB_BACKUP_RETENTION_DAYS=30
DB_BACKUP_S3_BUCKET=s3://corporate-intel-backups-prod/postgres

# ===============================================================================
# REDIS CACHE CONFIGURATION
# ===============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=REPLACE_WITH_AWS_SECRETS_MANAGER_REFERENCE
REDIS_DB=0
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Redis Performance Tuning
REDIS_CACHE_TTL=3600
REDIS_MAX_CONNECTIONS=100
REDIS_SOCKET_CONNECT_TIMEOUT=5
REDIS_SOCKET_KEEPALIVE=true
REDIS_RETRY_ON_TIMEOUT=true
REDIS_MAX_RETRIES=3

# Redis Persistence
REDIS_APPENDONLY=yes
REDIS_MAXMEMORY=4gb
REDIS_MAXMEMORY_POLICY=allkeys-lru

# Cache Strategy
ENABLE_CACHING=true
CACHE_DEFAULT_TIMEOUT=3600
CACHE_KEY_PREFIX=corp_intel_prod

# ===============================================================================
# MINIO OBJECT STORAGE
# ===============================================================================
MINIO_ENDPOINT=minio:9000
MINIO_ROOT_USER=intel_prod_admin
MINIO_ROOT_PASSWORD=REPLACE_WITH_AWS_SECRETS_MANAGER_REFERENCE
MINIO_SECURE=false
MINIO_REGION=us-east-1

# MinIO Buckets
MINIO_BUCKET_DOCUMENTS=corporate-documents-prod
MINIO_BUCKET_REPORTS=analysis-reports-prod
MINIO_BUCKET_BACKUPS=database-backups-prod
MINIO_BUCKET_FILINGS=sec-filings-prod
MINIO_BUCKET_EXPORTS=data-exports-prod

# Object Lifecycle
MINIO_LIFECYCLE_ENABLED=true
MINIO_LIFECYCLE_EXPIRY_DAYS=365

# ===============================================================================
# EXTERNAL API CONFIGURATION
# ===============================================================================

# Alpha Vantage (Financial Market Data)
# Tier: Premium - 75 requests/minute
# Documentation: https://www.alphavantage.co/documentation/
ALPHA_VANTAGE_API_KEY=REPLACE_WITH_PREMIUM_API_KEY
ALPHA_VANTAGE_BASE_URL=https://www.alphavantage.co/query
ALPHA_VANTAGE_RATE_LIMIT=75
ALPHA_VANTAGE_RETRY_ATTEMPTS=3
ALPHA_VANTAGE_TIMEOUT=30

# SEC EDGAR API (Required - No API Key)
# Rate Limit: 10 requests/second per IP
# User Agent MUST include contact email
SEC_USER_AGENT=Corporate Intel Platform/1.0 (production-contact@company.com)
SEC_BASE_URL=https://data.sec.gov
SEC_RATE_LIMIT=10
SEC_BULK_DOWNLOAD_URL=https://www.sec.gov/Archives/edgar/daily-index/bulkdata

# NewsAPI (News Data)
# Tier: Business - 250 requests/day
# Documentation: https://newsapi.org/docs
NEWSAPI_KEY=REPLACE_WITH_BUSINESS_API_KEY
NEWSAPI_BASE_URL=https://newsapi.org/v2
NEWSAPI_RATE_LIMIT=250
NEWSAPI_ENABLED=true

# Yahoo Finance (Market Data - Free)
YAHOO_FINANCE_ENABLED=true
YAHOO_FINANCE_BASE_URL=https://query1.finance.yahoo.com/v8/finance
YAHOO_FINANCE_RATE_LIMIT=2000

# Crunchbase (Company Intelligence - Optional)
# Tier: Enterprise
CRUNCHBASE_API_KEY=REPLACE_WITH_API_KEY_OR_REMOVE
CRUNCHBASE_BASE_URL=https://api.crunchbase.com/api/v4
CRUNCHBASE_ENABLED=false

# GitHub API (Code Intelligence - Optional)
# Personal Access Token with read:org scope
GITHUB_TOKEN=REPLACE_WITH_TOKEN_OR_REMOVE
GITHUB_API_URL=https://api.github.com
GITHUB_RATE_LIMIT=5000
GITHUB_ENABLED=false

# ===============================================================================
# API CONFIGURATION
# ===============================================================================
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_WORKER_CLASS=uvicorn.workers.UvicornWorker
API_TIMEOUT=120
API_KEEPALIVE=5
API_MAX_REQUESTS=10000
API_MAX_REQUESTS_JITTER=1000

# API Versioning
API_V1_PREFIX=/api/v1
API_VERSION=1.0.0

# Authentication
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_SPECIAL_CHARS=true
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_NUMBERS=true

# CORS Configuration (Strict Production)
CORS_ORIGINS=["https://corporate-intel.company.com","https://api.corporate-intel.company.com"]
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["GET","POST","PUT","DELETE","PATCH"]
CORS_ALLOW_HEADERS=["Authorization","Content-Type","X-Request-ID","X-API-Key"]
CORS_MAX_AGE=600

# Rate Limiting (Production-Grade)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_STRATEGY=sliding-window
RATE_LIMIT_STANDARD_PER_MINUTE=60
RATE_LIMIT_STANDARD_BURST=20
RATE_LIMIT_PREMIUM_PER_MINUTE=300
RATE_LIMIT_PREMIUM_BURST=100
RATE_LIMIT_ADMIN_PER_MINUTE=1000

# Request Validation
MAX_REQUEST_SIZE_MB=50
REQUEST_TIMEOUT_SECONDS=120
ENABLE_REQUEST_LOGGING=true
ENABLE_RESPONSE_COMPRESSION=true

# ===============================================================================
# WORKFLOW ORCHESTRATION - Prefect
# ===============================================================================
PREFECT_ENABLED=true
PREFECT_API_URL=http://prefect:4200/api
PREFECT_WORKSPACE=corporate-intel-prod
PREFECT_LOG_LEVEL=WARNING

# ===============================================================================
# DISTRIBUTED COMPUTING - Ray
# ===============================================================================
RAY_ENABLED=true
RAY_HEAD_ADDRESS=ray://ray-head:10001
RAY_NUM_CPUS=8
RAY_NUM_GPUS=0
RAY_OBJECT_STORE_MEMORY=4294967296

# ===============================================================================
# OBSERVABILITY & MONITORING
# ===============================================================================

# OpenTelemetry Configuration
OTEL_ENABLED=true
OTEL_EXPORTER_OTLP_ENDPOINT=http://jaeger:4317
OTEL_SERVICE_NAME=corporate-intel-prod
OTEL_TRACES_ENABLED=true
OTEL_METRICS_ENABLED=true
OTEL_LOGS_ENABLED=true
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=0.1
OTEL_PROPAGATORS=tracecontext,baggage

# Sentry Error Tracking
SENTRY_ENABLED=true
SENTRY_DSN=REPLACE_WITH_SENTRY_DSN
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1
SENTRY_SEND_DEFAULT_PII=false
SENTRY_ATTACH_STACKTRACE=true
SENTRY_MAX_BREADCRUMBS=50

# Prometheus Metrics
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION_DAYS=30
PROMETHEUS_SCRAPE_INTERVAL=15s

# Grafana Dashboard
GRAFANA_ENABLED=true
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=REPLACE_WITH_STRONG_PASSWORD
GRAFANA_ALLOW_SIGN_UP=false
GRAFANA_ORG_NAME=Corporate Intelligence
GRAFANA_SMTP_ENABLED=true

# ===============================================================================
# ALERTING & NOTIFICATIONS
# ===============================================================================

# Slack Integration
SLACK_ENABLED=true
SLACK_WEBHOOK_URL=REPLACE_WITH_SLACK_WEBHOOK_URL
SLACK_ALERTS_CHANNEL=#production-alerts
SLACK_CRITICAL_CHANNEL=#critical-alerts
SLACK_MONITORING_CHANNEL=#monitoring

# PagerDuty Integration
PAGERDUTY_ENABLED=true
PAGERDUTY_SERVICE_KEY=REPLACE_WITH_PAGERDUTY_SERVICE_KEY
PAGERDUTY_API_KEY=REPLACE_WITH_PAGERDUTY_API_KEY
PAGERDUTY_DB_INCIDENT_KEY=REPLACE_WITH_DB_INCIDENT_KEY

# Email Notifications (SMTP)
EMAIL_ENABLED=true
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USERNAME=REPLACE_WITH_SMTP_USERNAME
SMTP_PASSWORD=REPLACE_WITH_SMTP_APP_PASSWORD
SMTP_FROM_ADDRESS=alerts@corporate-intel.company.com
SMTP_FROM_NAME=Corporate Intel Alerts
ALERT_EMAIL_TO=oncall@corporate-intel.company.com,devops@corporate-intel.company.com

# Alert Thresholds
ALERT_CPU_THRESHOLD=80
ALERT_MEMORY_THRESHOLD=85
ALERT_DISK_THRESHOLD=90
ALERT_API_ERROR_RATE=0.01
ALERT_API_LATENCY_P95_MS=1000
ALERT_DB_CONNECTION_THRESHOLD=80

# ===============================================================================
# BACKUP & DISASTER RECOVERY
# ===============================================================================

# Automated Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESSION=gzip
BACKUP_ENCRYPTION_ENABLED=true

# S3 Backup Storage
S3_BACKUP_ENABLED=true
S3_BUCKET_NAME=corporate-intel-backups-prod
S3_BUCKET_REGION=us-east-1
AWS_ACCESS_KEY_ID=REPLACE_WITH_AWS_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=REPLACE_WITH_AWS_SECRET_KEY

# Backup Verification
BACKUP_VERIFICATION_ENABLED=true
BACKUP_TEST_RESTORE_SCHEDULE=0 3 * * 0

# Disaster Recovery
DR_ENABLED=true
DR_REGION=us-west-2
DR_SYNC_INTERVAL=300
DR_RTO_MINUTES=60
DR_RPO_MINUTES=15

# ===============================================================================
# SSL/TLS CONFIGURATION
# ===============================================================================

# Domain Configuration
DOMAIN_NAME=corporate-intel.company.com
API_DOMAIN=api.corporate-intel.company.com
ADMIN_DOMAIN=admin.corporate-intel.company.com

# SSL Certificates
SSL_ENABLED=true
SSL_CERTIFICATE_PATH=/etc/letsencrypt/live/${DOMAIN_NAME}/fullchain.pem
SSL_CERTIFICATE_KEY_PATH=/etc/letsencrypt/live/${DOMAIN_NAME}/privkey.pem
SSL_TRUSTED_CERTIFICATE=/etc/letsencrypt/live/${DOMAIN_NAME}/chain.pem

# Let's Encrypt
LETSENCRYPT_EMAIL=ssl-admin@corporate-intel.company.com
LETSENCRYPT_AUTO_RENEWAL=true
LETSENCRYPT_RENEWAL_DAYS_BEFORE_EXPIRY=30

# TLS Settings
TLS_MIN_VERSION=1.2
TLS_CIPHERS=ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256

# ===============================================================================
# DATA PROCESSING & PIPELINE
# ===============================================================================

# Pipeline Execution
PIPELINE_ENABLED=true
PIPELINE_MAX_WORKERS=4
PIPELINE_RETRY_MAX_ATTEMPTS=3
PIPELINE_RETRY_BACKOFF_SECONDS=300
PIPELINE_TIMEOUT_HOURS=24

# Data Quality
DATA_QUALITY_ENABLED=true
DATA_QUALITY_STRICT_MODE=true
DATA_QUALITY_ALERT_ON_FAILURE=true
DATA_QUALITY_MIN_COMPLETENESS=0.95
DATA_QUALITY_MAX_STALENESS_HOURS=24

# Anomaly Detection
ANOMALY_DETECTION_ENABLED=true
ANOMALY_DETECTION_MODEL=isolation_forest
ANOMALY_DETECTION_THRESHOLD=0.85

# ===============================================================================
# MACHINE LEARNING & EMBEDDINGS
# ===============================================================================

# Embeddings Configuration
EMBEDDING_ENABLED=true
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
EMBEDDING_DIMENSION=384
EMBEDDING_BATCH_SIZE=64
EMBEDDING_DEVICE=cpu

# Vector Database (pgvector)
VECTOR_ENABLED=true
VECTOR_DIMENSION=1536
VECTOR_INDEX_TYPE=ivfflat
VECTOR_LISTS=100
VECTOR_PROBES=10

# Model Storage
MODEL_CACHE_DIR=/app/models
MODEL_S3_BUCKET=corporate-intel-models-prod

# ===============================================================================
# FEATURE FLAGS
# ===============================================================================
ENABLE_RATE_LIMITING=true
ENABLE_MONITORING=true
ENABLE_TRACING=true
ENABLE_PROFILING=false
ENABLE_API_DOCS=false
ENABLE_DEBUG_TOOLBAR=false
ENABLE_SWAGGER_UI=false
ENABLE_REDOC=false

# Beta Features
ENABLE_AI_INSIGHTS=true
ENABLE_REAL_TIME_ANALYTICS=true
ENABLE_ADVANCED_SEARCH=true

# ===============================================================================
# EDTECH COMPANIES WATCHLIST
# ===============================================================================
# Primary watchlist for automated monitoring
EDTECH_COMPANIES_WATCHLIST=["CHGG","COUR","DUOL","TWOU","ARCE","LAUR","INST","POWL"]

# Extended monitoring (optional)
EDTECH_EXTENDED_WATCHLIST=["UDMY","2U","STRY","BOXL"]

# ===============================================================================
# HEALTH CHECKS & LIVENESS
# ===============================================================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=40

# Readiness Checks
READINESS_CHECK_DB=true
READINESS_CHECK_REDIS=true
READINESS_CHECK_MINIO=true
READINESS_CHECK_EXTERNAL_APIS=false

# ===============================================================================
# AWS INTEGRATION
# ===============================================================================

# AWS Secrets Manager
AWS_SECRETS_MANAGER_ENABLED=true
AWS_SECRETS_MANAGER_SECRET_NAME=corporate-intel-prod-secrets
AWS_SECRETS_MANAGER_REGION=us-east-1

# AWS CloudWatch
AWS_CLOUDWATCH_ENABLED=true
AWS_CLOUDWATCH_LOG_GROUP=/aws/corporate-intel/prod
AWS_CLOUDWATCH_STREAM_NAME=api-logs
AWS_CLOUDWATCH_RETENTION_DAYS=30

# AWS RDS (If using managed database)
# RDS_ENABLED=false
# RDS_ENDPOINT=REPLACE_WITH_RDS_ENDPOINT
# RDS_CA_BUNDLE=/etc/ssl/certs/rds-ca-2019-root.pem

# AWS SES (Email Service)
# AWS_SES_ENABLED=false
# AWS_SES_REGION=us-east-1
# AWS_SES_FROM_EMAIL=noreply@corporate-intel.company.com

# ===============================================================================
# DOCKER & CONTAINER CONFIGURATION
# ===============================================================================
COMPOSE_PROJECT_NAME=corporate-intel-prod
COMPOSE_FILE=docker-compose.production.yml
DOCKER_BUILDKIT=1
COMPOSE_DOCKER_CLI_BUILD=1

# Container Resources
CONTAINER_MEMORY_LIMIT=4096m
CONTAINER_CPU_LIMIT=2.0
CONTAINER_RESTART_POLICY=unless-stopped

# ===============================================================================
# COMPLIANCE & AUDIT
# ===============================================================================
AUDIT_LOGGING_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=365
COMPLIANCE_MODE=SOC2
DATA_RESIDENCY=US
GDPR_COMPLIANCE=true
CCPA_COMPLIANCE=true

# ===============================================================================
# PERFORMANCE TUNING
# ===============================================================================

# Application Performance
WORKER_TIMEOUT=120
GRACEFUL_TIMEOUT=30
KEEP_ALIVE=5
MAX_REQUESTS=10000
MAX_REQUESTS_JITTER=1000

# Database Performance
STATEMENT_TIMEOUT=30000
IDLE_IN_TRANSACTION_SESSION_TIMEOUT=60000

# Cache Performance
CACHE_PRELOAD_ON_STARTUP=true
CACHE_WARMING_ENABLED=true

# ===============================================================================
# SECURITY SCANNING & VULNERABILITY MANAGEMENT
# ===============================================================================
SECURITY_SCANNING_ENABLED=true
VULNERABILITY_SCANNING_SCHEDULE=0 4 * * *
DEPENDENCY_CHECK_ENABLED=true
CODE_SCANNING_ENABLED=true

# ===============================================================================
# DEPLOYMENT METADATA & TRACKING
# ===============================================================================
# Automatically populated by CI/CD pipeline
GIT_COMMIT_SHA=REPLACE_WITH_COMMIT_SHA
GIT_BRANCH=main
DEPLOY_TIMESTAMP=REPLACE_WITH_TIMESTAMP
DEPLOYED_BY=REPLACE_WITH_DEPLOYER
BUILD_NUMBER=REPLACE_WITH_BUILD_NUMBER

# ===============================================================================
# NOTES & DOCUMENTATION LINKS
# ===============================================================================
# 1. Secret Generation: See docs/deployment/secrets-management.md
# 2. AWS Setup: See docs/deployment/aws-integration.md
# 3. SSL Configuration: See docs/deployment/ssl-setup.md
# 4. Monitoring Setup: See docs/deployment/monitoring-setup.md
# 5. Backup Procedures: See docs/deployment/backup-procedures.md
# 6. Disaster Recovery: See docs/deployment/disaster-recovery.md
# 7. Security Hardening: See docs/deployment/security-hardening.md
# 8. Performance Tuning: See docs/deployment/performance-tuning.md
#
# SECURITY CHECKLIST BEFORE DEPLOYMENT:
# [ ] All REPLACE_WITH_* placeholders replaced with actual values
# [ ] All secrets stored in AWS Secrets Manager or Vault
# [ ] SSL certificates obtained and configured
# [ ] Database backups tested and verified
# [ ] Monitoring alerts configured and tested
# [ ] Rate limiting thresholds appropriate for usage
# [ ] External API rate limits documented
# [ ] Security scanning completed
# [ ] Penetration testing completed
# [ ] Disaster recovery procedures tested
# [ ] On-call rotation configured
# ===============================================================================
